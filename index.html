<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PooPoo Tycoon: Ultra Satisfying Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;700;900&display=swap');
        
        body {
            background-color: #fdfcf0;
            font-family: 'Lexend', sans-serif;
            overflow: hidden;
            user-select: none;
        }

        .glass {
            background: rgba(255, 255, 255, 0.4);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .frenzy-overlay {
            position: fixed;
            inset: 0;
            pointer-events: none;
            z-index: 0;
            background: radial-gradient(circle, rgba(251, 191, 36, 0.15) 0%, transparent 70%);
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .frenzy-active .frenzy-overlay {
            opacity: 1;
        }

        @keyframes float-up-fast {
            0% { transform: translateY(0) scale(0.5); opacity: 1; }
            100% { transform: translateY(-150px) scale(1.5); opacity: 0; }
        }

        .pop-text {
            position: absolute;
            pointer-events: none;
            animation: float-up-fast 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
            font-weight: 900;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }
        ::-webkit-scrollbar-track {
            background: transparent;
        }
        ::-webkit-scrollbar-thumb {
            background: #dcd2b3;
            border-radius: 10px;
        }
    </style>
    <script type="importmap">
    {
      "imports": {
        "react": "https://esm.sh/react@18.2.0",
        "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
        "framer-motion": "https://esm.sh/framer-motion@11.0.0",
        "@google/genai": "https://esm.sh/@google/genai@1.38.0"
      }
    }
    </script>
</head>
<body>
    <div id="root"></div>
    <script type="module">
      import React, { useState, useEffect, useCallback, useRef } from 'react';
      import { createRoot } from 'react-dom/client';
      import { motion, AnimatePresence, useAnimation } from 'framer-motion';
      import { GoogleGenAI } from '@google/genai';

      // ============ CONSTANTS ============
      const INITIAL_UPGRADES = [
        { id: 'tp_single', name: 'Single Ply TP', description: 'Increases your click power by 1.', basePrice: 15, multiplier: 1.15, type: 'click', value: 1, owned: 0, icon: 'ðŸ§»' },
        { id: 'tp_luxury', name: 'Quilted Northern', description: 'Increases your click power by 5.', basePrice: 150, multiplier: 1.2, type: 'click', value: 5, owned: 0, icon: 'ðŸš½' },
        { id: 'golden_plunger', name: 'Golden Plunger', description: 'The ultimate tool. Increases click power by 25.', basePrice: 1000, multiplier: 1.3, type: 'click', value: 25, owned: 0, icon: 'ðŸ”±' },
        { id: 'lucky_corn', name: 'Lucky Corn', description: 'Adds 2% chance to land a critical hit.', basePrice: 500, multiplier: 1.5, type: 'crit_chance', value: 0.02, owned: 0, icon: 'ðŸŒ½' },
        { id: 'sharp_porcelain', name: 'Sharp Porcelain', description: 'Critical hits deal 1x more damage.', basePrice: 800, multiplier: 1.6, type: 'crit_multi', value: 1.0, owned: 0, icon: 'ðŸ’ ' },
        { id: 'diaper_duty', name: 'Baby Diapers', description: 'A small source of income. +1 PPS.', basePrice: 50, multiplier: 1.12, type: 'passive', value: 1, owned: 0, icon: 'ðŸ‘¶' },
        { id: 'stray_dog', name: 'Stray Dog', description: 'Loyal and productive. +5 PPS.', basePrice: 300, multiplier: 1.15, type: 'passive', value: 5, owned: 0, icon: 'ðŸ•' },
        { id: 'porta_potty', name: 'Porta-Potty', description: 'Portable and profitable. +15 PPS.', basePrice: 1200, multiplier: 1.18, type: 'passive', value: 15, owned: 0, icon: 'â›º' },
        { id: 'golden_fiber', name: 'Golden Fiber', description: 'Golden Poops spawn 10% more often.', basePrice: 2000, multiplier: 1.8, type: 'golden_chance', value: 0.1, owned: 0, icon: 'ðŸŒ¾' },
        { id: 'shiny_polish', name: 'Shiny Polish', description: 'Golden Buff lasts 5 seconds longer.', basePrice: 5000, multiplier: 1.9, type: 'golden_duration', value: 5, owned: 0, icon: 'âœ¨' },
        { id: 'alchemy_bowl', name: 'Alchemist Bowl', description: 'Golden Poop multiplier increased by 2x.', basePrice: 10000, multiplier: 2.0, type: 'golden_power', value: 2, owned: 0, icon: 'ðŸº' },
        { id: 'city_sewer', name: 'City Sewer System', description: 'Industrial scale production. +50 PPS.', basePrice: 5000, multiplier: 1.2, type: 'passive', value: 50, owned: 0, icon: 'ðŸ™ï¸' },
        { id: 'sewage_plant', name: 'Treatment Plant', description: 'Efficient and automated. +200 PPS.', basePrice: 25000, multiplier: 1.22, type: 'passive', value: 200, owned: 0, icon: 'ðŸ­' },
        { id: 'poop_dimension', name: 'The Brown Portal', description: 'Tapping into a parallel reality. +1000 PPS.', basePrice: 150000, multiplier: 1.25, type: 'passive', value: 1000, owned: 0, icon: 'ðŸŒ€' }
      ];

      const INITIAL_ACHIEVEMENTS = [
        { id: 'first_poop', name: 'Fresh Start', description: 'Collect your first 10 poops.', requirement: 10, type: 'total', unlocked: false },
        { id: 'hunder_poop', name: 'Century Club', description: 'Collect 100 poops.', requirement: 100, type: 'total', unlocked: false },
        { id: 'k_poop', name: 'Kilogram of Gold', description: 'Collect 1,000 poops.', requirement: 1000, type: 'total', unlocked: false },
        { id: 'pps_10', name: 'Steady Flow', description: 'Reach 10 PPS.', requirement: 10, type: 'pps', unlocked: false },
        { id: 'pps_100', name: 'Industrialist', description: 'Reach 100 PPS.', requirement: 100, type: 'pps', unlocked: false }
      ];

      // ============ GEMINI SERVICE ============
      class GeminiService {
        async getPoopWisdom() {
          try {
            const apiKey = 'YOUR_API_KEY_HERE'; // Replace with your actual API key
            const ai = new GoogleGenAI({ apiKey });
            const response = await ai.models.generateContent({
              model: 'gemini-3-flash-preview',
              contents: "Give me a single sentence of 'poop wisdom' or a funny poop pun for a clicker game. Keep it short and cheeky.",
              config: {
                systemInstruction: "You are the 'Great Poo-dha', a mystical entity in a poop clicker game. You provide funny, short, and engaging puns or wise sayings related to bathrooms, digestion, and waste.",
                temperature: 0.9,
              }
            });
            return response.text?.trim() || "Stay regular, my friend.";
          } catch (error) {
            console.error("Gemini Error:", error);
            return "Sometimes you gotta just go with the flow.";
          }
        }
      }
      const geminiService = new GeminiService();

      // ============ COMPONENTS ============
      
      // GoldenPoop Component
      const GoldenPoop = ({ visible, position, onClick }) => {
        return React.createElement(AnimatePresence, null,
          visible && React.createElement(motion.button, {
            initial: { scale: 0, rotate: -180, opacity: 0 },
            animate: { scale: 1, rotate: 0, opacity: 1 },
            exit: { scale: 0, opacity: 0 },
            whileHover: { scale: 1.2 },
            whileTap: { scale: 0.8 },
            onClick: onClick,
            className: "fixed z-[100] text-7xl filter drop-shadow-[0_0_20px_rgba(251,191,36,0.8)] cursor-pointer select-none touch-none",
            style: { 
              left: `${position.x}%`, 
              top: `${position.y}%`,
              transform: 'translate(-50%, -50%)'
            }
          },
            React.createElement(motion.div, {
              animate: { 
                filter: ['brightness(1)', 'brightness(1.5)', 'brightness(1)'],
                scale: [1, 1.05, 1]
              },
              transition: { repeat: Infinity, duration: 1 }
            },
              'ðŸ’©',
              React.createElement('div', { className: "absolute inset-0 text-7xl opacity-40 mix-blend-overlay" }, 'âœ¨')
            ),
            React.createElement('div', { 
              className: "absolute -top-8 left-1/2 -translate-x-1/2 bg-yellow-400 text-white text-[10px] font-black px-2 py-0.5 rounded-full whitespace-nowrap uppercase tracking-widest shadow-lg" 
            }, 'Click Me!')
          )
        );
      };

      // PoopWisdom Component
      const PoopWisdom = ({ totalPoops }) => {
        const [wisdom, setWisdom] = useState("Tap for the golden fortune.");
        const [loading, setLoading] = useState(false);
        const [lastThreshold, setLastThreshold] = useState(0);

        const fetchWisdom = async () => {
          setLoading(true);
          const newWisdom = await geminiService.getPoopWisdom();
          setWisdom(newWisdom);
          setLoading(false);
        };

        useEffect(() => {
          const threshold = Math.floor(totalPoops / 500);
          if (threshold > lastThreshold) {
            setLastThreshold(threshold);
            fetchWisdom();
          }
        }, [totalPoops, lastThreshold]);

        return React.createElement('div', { 
          className: "bg-[#78350f] text-[#fdfcf0] p-4 rounded-2xl shadow-inner relative overflow-hidden" 
        },
          React.createElement('div', { className: "text-[10px] uppercase font-black opacity-40 mb-1 tracking-[0.2em]" }, 'The Poo-dha Speaks'),
          React.createElement('p', { 
            className: `italic text-sm font-medium leading-relaxed transition-opacity duration-500 ${loading ? 'opacity-30' : 'opacity-100'}` 
          }, `"${wisdom}"`),
          React.createElement('button', {
            onClick: fetchWisdom,
            disabled: loading,
            className: "mt-3 text-[10px] bg-white/20 hover:bg-white/30 px-2 py-1 rounded font-bold uppercase tracking-wider transition-colors disabled:opacity-50"
          }, 'Seek Guidance'),
          React.createElement('div', { 
            className: "absolute -bottom-2 -right-2 opacity-10 text-4xl transform rotate-12" 
          }, 'ðŸ“¿')
        );
      };

      // Stats Component
      const Stats = ({ pps, cpc, total, current }) => {
        return React.createElement('div', { className: "grid grid-cols-2 gap-3" },
          React.createElement('div', { className: "bg-white/60 p-3 rounded-xl border-2 border-[#dcd2b3]" },
            React.createElement('div', { className: "text-[10px] uppercase font-bold text-gray-500 tracking-wider" }, 'Per Second'),
            React.createElement('div', { className: "text-xl font-black text-[#78350f]" }, pps.toLocaleString())
          ),
          React.createElement('div', { className: "bg-white/60 p-3 rounded-xl border-2 border-[#dcd2b3]" },
            React.createElement('div', { className: "text-[10px] uppercase font-bold text-gray-500 tracking-wider" }, 'Per Click'),
            React.createElement('div', { className: "text-xl font-black text-[#78350f]" }, cpc.toLocaleString())
          ),
          React.createElement('div', { className: "col-span-2 bg-white/60 p-3 rounded-xl border-2 border-[#dcd2b3]" },
            React.createElement('div', { className: "text-[10px] uppercase font-bold text-gray-500 tracking-wider" }, 'Lifetime Total'),
            React.createElement('div', { className: "text-lg font-black text-[#78350f]" }, Math.floor(total).toLocaleString())
          )
        );
      };

      // Shop Component
      const getBenefitLabel = (type, value) => {
        switch(type) {
          case 'click': return `+${value} Click`;
          case 'passive': return `+${value} PPS`;
          case 'crit_chance': return `+${(value * 100).toFixed(0)}% Crit`;
          case 'crit_multi': return `+${value}x Crit`;
          case 'golden_chance': return `+${(value * 100).toFixed(0)}% Luck`;
          case 'golden_duration': return `+${value}s Buff`;
          case 'golden_power': return `+${value}x Buff`;
          default: return '';
        }
      };

      const Shop = ({ upgrades, poops, onBuy }) => {
        return React.createElement('div', { className: "flex flex-col gap-3 pb-20" },
          upgrades.map((u, idx) => {
            const cost = Math.floor(u.basePrice * Math.pow(u.multiplier, u.owned));
            const canAfford = poops >= cost;

            return React.createElement(motion.button, {
              key: u.id,
              initial: { x: 50, opacity: 0 },
              animate: { x: 0, opacity: 1 },
              transition: { delay: idx * 0.05 },
              onClick: () => onBuy(u.id),
              disabled: !canAfford,
              whileHover: canAfford ? { scale: 1.02, x: -5 } : {},
              whileTap: canAfford ? { scale: 0.95 } : {},
              className: `group relative flex items-center gap-4 p-4 rounded-2xl border-2 transition-all overflow-hidden ${canAfford ? 'bg-white border-white/50 shadow-sm hover:shadow-md cursor-pointer' : 'bg-gray-100/50 border-transparent opacity-60 cursor-not-allowed grayscale'}`
            },
              React.createElement('div', { 
                className: `text-3xl w-14 h-14 rounded-xl flex items-center justify-center transition-transform group-hover:rotate-12 ${canAfford ? 'bg-orange-50' : 'bg-gray-200'}` 
              }, u.icon),
              React.createElement('div', { className: "flex-1 text-left" },
                React.createElement('div', { className: "flex justify-between items-start" },
                  React.createElement('span', { className: "font-bold text-[#78350f]" }, u.name),
                  React.createElement('span', { className: "font-black text-[10px] bg-[#78350f] text-white px-2 py-0.5 rounded-full" }, `Lv ${u.owned}`)
                ),
                React.createElement('p', { className: "text-[10px] text-gray-500 font-medium mb-1 line-clamp-1" }, u.description),
                React.createElement('div', { className: "flex justify-between items-center mt-1" },
                  React.createElement('span', { className: `font-black text-sm ${canAfford ? 'text-orange-600' : 'text-gray-400'}` }, 
                    `ðŸ’© ${cost.toLocaleString()}`
                  ),
                  React.createElement('span', { className: "text-[9px] font-black text-gray-400 uppercase tracking-tighter" }, 
                    getBenefitLabel(u.type, u.value)
                  )
                )
              ),
              !canAfford && React.createElement('div', { className: "absolute inset-0 bg-white/10 pointer-events-none" })
            );
          })
        );
      };

      // Clicker Component
      const Clicker = ({ onClick, cpc, isFrenzy, isGolden }) => {
        const controls = useAnimation();
        const [particles, setParticles] = useState([]);

        const handleInteraction = async (e) => {
          const clientX = e.clientX || e.touches?.[0].clientX;
          const clientY = e.clientY || e.touches?.[0].clientY;

          const isCrit = onClick();

          controls.start({
            scale: isCrit ? [1, 0.7, 1.3, 1] : [1, 0.85, 1.1, 1],
            rotate: isCrit ? [0, -15, 15, 0] : [0, -5, 5, 0],
            transition: { duration: 0.15, ease: "easeOut" }
          });

          const newParticles = Array.from({ length: isCrit ? 12 : 5 }).map((_, i) => ({
            id: Date.now() + i,
            x: clientX,
            y: clientY,
            isCrit
          }));

          setParticles(prev => [...prev, ...newParticles]);
          setTimeout(() => {
            setParticles(prev => prev.filter(p => !newParticles.find(np => np.id === p.id)));
          }, 1000);
        };

        return React.createElement('div', { className: "relative" },
          particles.map(p =>
            React.createElement(motion.div, {
              key: p.id,
              initial: { x: p.x, y: p.y, opacity: 1, scale: p.isCrit ? 1.5 : 1 },
              animate: { 
                x: p.x + (Math.random() - 0.5) * 600, 
                y: p.y - Math.random() * 600,
                opacity: 0,
                scale: 0.2,
                rotate: Math.random() * 720
              },
              transition: { duration: 0.8, ease: "easeOut" },
              className: "fixed pointer-events-none z-[99] text-3xl",
              style: { top: 0, left: 0 }
            }, p.isCrit ? 'ðŸ’¥' : (isGolden ? 'ðŸ’°' : (isFrenzy ? 'âœ¨' : 'ðŸ’©')))
          ),
          React.createElement(motion.div, {
            animate: { 
              scale: (isFrenzy || isGolden) ? [1, 1.4, 1] : 1.2,
              opacity: (isFrenzy || isGolden) ? [0.3, 0.6, 0.3] : 0.1,
              backgroundColor: isGolden ? '#fbbf24' : (isFrenzy ? '#f97316' : '#78350f')
            },
            transition: { repeat: Infinity, duration: 2 },
            className: "absolute inset-0 rounded-full blur-3xl"
          }),
          React.createElement(motion.button, {
            animate: controls,
            onPointerDown: handleInteraction,
            className: "relative text-[180px] md:text-[240px] leading-none select-none touch-none outline-none filter drop-shadow-2xl",
            whileHover: { scale: 1.05 },
            style: { cursor: 'pointer' }
          },
            React.createElement('span', { className: "block drop-shadow-[0_10px_10px_rgba(0,0,0,0.2)]" },
              isGolden ? 'ðŸ’Ž' : (isFrenzy ? 'ðŸ‘‘' : 'ðŸ’©')
            )
          ),
          React.createElement(motion.div, {
            key: cpc,
            initial: { opacity: 0, y: 0 },
            animate: { opacity: 1, y: -20 },
            className: `absolute -top-12 left-1/2 -translate-x-1/2 font-black text-3xl ${isGolden ? 'text-yellow-600' : 'text-[#78350f]'}`
          }, `+${Math.floor(cpc).toLocaleString()}`)
        );
      };

      // AchievementCard Component
      const AchievementCard = ({ ach, totalPoops, pps }) => {
        const isUnlocked = (ach.type === 'total' && totalPoops >= ach.requirement) || (ach.type === 'pps' && pps >= ach.requirement);
        return React.createElement(motion.div, {
          animate: { filter: isUnlocked ? 'grayscale(0%)' : 'grayscale(100%)', opacity: isUnlocked ? 1 : 0.4 },
          className: `p-3 rounded-xl border-2 transition-all ${isUnlocked ? 'bg-[#78350f] text-white border-orange-400' : 'bg-white/40 border-gray-200'}`
        },
          React.createElement('div', { className: "font-bold text-xs uppercase tracking-wider" }, ach.name),
          React.createElement('div', { className: "text-[10px] opacity-80" }, ach.description)
        );
      };

      // ============ MAIN APP ============
      const App = () => {
        const [poops, setPoops] = useState(0);
        const [totalPoops, setTotalPoops] = useState(0);
        const [upgrades, setUpgrades] = useState(INITIAL_UPGRADES);
        const [achievements, setAchievements] = useState(INITIAL_ACHIEVEMENTS);
        
        const [pps, setPps] = useState(0);
        const [cpc, setCpc] = useState(1);
        const [critChance, setCritChance] = useState(0.05);
        const [critMulti, setCritMulti] = useState(2.0);
        
        const [goldenChanceMulti, setGoldenChanceMulti] = useState(1.0);
        const [goldenBaseDuration, setGoldenBaseDuration] = useState(15);
        const [goldenBasePower, setGoldenBasePower] = useState(7);

        const [notifications, setNotifications] = useState([]);
        const [combo, setCombo] = useState(0);
        const [isFrenzy, setIsFrenzy] = useState(false);
        const [goldenBuffActive, setGoldenBuffActive] = useState(false);
        const [goldenBuffTime, setGoldenBuffTime] = useState(0);
        const [goldenPoopVisible, setGoldenPoopVisible] = useState(false);
        const [goldenPoopPos, setGoldenPoopPos] = useState({ x: 50, y: 50 });

        const comboTimeout = useRef(null);
        const goldenSpawnInterval = useRef(null);

        useEffect(() => {
          let newPps = 0;
          let newCpc = 1;
          let newCritChance = 0.05;
          let newCritMulti = 2.0;
          let newGoldenChance = 1.0;
          let newGoldenDur = 15;
          let newGoldenPow = 7;

          upgrades.forEach(u => {
            const effect = u.value * u.owned;
            if (u.type === 'passive') newPps += effect;
            if (u.type === 'click') newCpc += effect;
            if (u.type === 'crit_chance') newCritChance += effect;
            if (u.type === 'crit_multi') newCritMulti += effect;
            if (u.type === 'golden_chance') newGoldenChance += effect;
            if (u.type === 'golden_duration') newGoldenDur += effect;
            if (u.type === 'golden_power') newGoldenPow += effect;
          });

          setPps(newPps);
          setCpc(newCpc);
          setCritChance(newCritChance);
          setCritMulti(newCritMulti);
          setGoldenChanceMulti(newGoldenChance);
          setGoldenBaseDuration(newGoldenDur);
          setGoldenBasePower(newGoldenPow);
        }, [upgrades]);

        useEffect(() => {
          const interval = setInterval(() => {
            const frenzyMulti = isFrenzy ? 3 : 1;
            const goldenMulti = goldenBuffActive ? goldenBasePower : 1;
            const amount = (pps * frenzyMulti * goldenMulti) / 20;
            if (amount > 0) {
              setPoops(prev => prev + amount);
              setTotalPoops(prev => prev + amount);
            }
          }, 50);
          return () => clearInterval(interval);
        }, [pps, isFrenzy, goldenBuffActive, goldenBasePower]);

        useEffect(() => {
          const spawnCheck = () => {
            const baseSpawnInterval = 60000 / goldenChanceMulti;
            
            goldenSpawnInterval.current = window.setTimeout(() => {
              if (!goldenPoopVisible) {
                setGoldenPoopPos({
                  x: 10 + Math.random() * 80,
                  y: 10 + Math.random() * 80
                });
                setGoldenPoopVisible(true);
                setTimeout(() => setGoldenPoopVisible(false), 10000);
              }
              spawnCheck();
            }, baseSpawnInterval);
          };

          spawnCheck();
          return () => { if (goldenSpawnInterval.current) clearTimeout(goldenSpawnInterval.current); };
        }, [goldenChanceMulti, goldenPoopVisible]);

        useEffect(() => {
          if (goldenBuffActive && goldenBuffTime > 0) {
            const timer = setInterval(() => setGoldenBuffTime(prev => prev - 1), 1000);
            return () => clearInterval(timer);
          } else if (goldenBuffTime <= 0) {
            setGoldenBuffActive(false);
          }
        }, [goldenBuffActive, goldenBuffTime]);

        const handleGoldenPoopClick = () => {
          setGoldenPoopVisible(false);
          setGoldenBuffActive(true);
          setGoldenBuffTime(goldenBaseDuration);
          addNotification(`âœ¨ GOLDEN FLUSH! ${goldenBasePower}X MULTIPLIER! âœ¨`);
        };

        const handleManualClick = useCallback(() => {
          const frenzyMulti = isFrenzy ? 2 : 1;
          const goldenMulti = goldenBuffActive ? goldenBasePower : 1;
          
          const isCrit = Math.random() < critChance;
          const critBonus = isCrit ? critMulti : 1;
          
          const gain = cpc * frenzyMulti * goldenMulti * critBonus;
          setPoops(prev => prev + gain);
          setTotalPoops(prev => prev + gain);

          setCombo(prev => {
            const next = prev + 1;
            if (next >= 50 && !isFrenzy) {
              setIsFrenzy(true);
              addNotification("ðŸ”¥ FIBER FRENZY ACTIVATED! ðŸ”¥");
              setTimeout(() => setIsFrenzy(false), 10000);
              return 0;
            }
            return next;
          });

          if (comboTimeout.current) window.clearTimeout(comboTimeout.current);
          comboTimeout.current = window.setTimeout(() => setCombo(0), 1000);

          return isCrit;
        }, [cpc, isFrenzy, goldenBuffActive, goldenBasePower, critChance, critMulti]);

        const addNotification = (text) => {
          const id = Date.now();
          setNotifications(prev => [...prev, { id, text }]);
          setTimeout(() => setNotifications(prev => prev.filter(n => n.id !== id)), 4000);
        };

        const buyUpgrade = (upgradeId) => {
          setUpgrades(prev => prev.map(u => {
            if (u.id === upgradeId) {
              const cost = Math.floor(u.basePrice * Math.pow(u.multiplier, u.owned));
              if (poops >= cost) {
                setPoops(prevPoops => prevPoops - cost);
                return { ...u, owned: u.owned + 1 };
              }
            }
            return u;
          }));
        };

        return React.createElement('div', { 
          className: `min-h-screen flex flex-col md:flex-row bg-[#fdfcf0] text-[#4a2c2c] transition-colors duration-1000 ${isFrenzy ? 'frenzy-active' : ''}` 
        },
          React.createElement('div', { className: "frenzy-overlay" }),
          
          goldenBuffActive && React.createElement('div', { 
            className: "fixed inset-0 pointer-events-none z-0 bg-yellow-400/10 animate-pulse border-[10px] border-yellow-400/30" 
          }),

          // Sidebar
          React.createElement(motion.div, {
            initial: { x: -100, opacity: 0 },
            animate: { x: 0, opacity: 1 },
            className: "z-10 w-full md:w-80 p-6 flex flex-col gap-6 bg-[#efe9d5] border-r-4 border-[#dcd2b3] shadow-2xl"
          },
            React.createElement('div', { className: "text-center" },
              React.createElement(motion.h1, {
                animate: isFrenzy ? { scale: [1, 1.1, 1], color: ['#78350f', '#f59e0b', '#78350f'] } : {},
                transition: { repeat: Infinity, duration: 1 },
                className: "text-4xl font-black text-[#78350f]"
              }, 'PooPoo Tycoon'),
              React.createElement('div', { className: "h-2 bg-gray-200 rounded-full mt-4 overflow-hidden" },
                React.createElement(motion.div, {
                  className: "h-full bg-orange-500",
                  animate: { width: `${(combo / 50) * 100}%` }
                })
              ),
              React.createElement('p', { className: "text-[10px] font-bold uppercase mt-1 opacity-50 tracking-tighter" }, 'Frenzy Meter')
            ),
            
            React.createElement(Stats, {
              pps: pps * (isFrenzy ? 3 : 1) * (goldenBuffActive ? goldenBasePower : 1),
              cpc: cpc * (isFrenzy ? 2 : 1) * (goldenBuffActive ? goldenBasePower : 1),
              total: totalPoops,
              current: poops
            }),
            
            React.createElement(PoopWisdom, { totalPoops }),

            React.createElement('div', { className: "flex-1 overflow-hidden flex flex-col" },
              React.createElement('h2', { className: "text-xl font-bold mb-4 border-b-2 border-[#78350f] pb-1" }, 'Trophies'),
              React.createElement('div', { className: "space-y-2 overflow-y-auto pr-2" },
                achievements.map(ach =>
                  React.createElement(AchievementCard, { key: ach.id, ach, totalPoops, pps })
                )
              )
            )
          ),

          // Main Game
          React.createElement('main', { className: "flex-1 relative flex flex-col items-center justify-center p-8 overflow-hidden z-10" },
            React.createElement(GoldenPoop, { 
              visible: goldenPoopVisible, 
              position: goldenPoopPos, 
              onClick: handleGoldenPoopClick 
            }),

            React.createElement('div', { className: "absolute top-4 right-4 flex flex-col gap-2 pointer-events-none z-50" },
              React.createElement(AnimatePresence, null,
                notifications.map((n) =>
                  React.createElement(motion.div, {
                    key: n.id,
                    initial: { opacity: 0, x: 50, scale: 0.8 },
                    animate: { opacity: 1, x: 0, scale: 1 },
                    exit: { opacity: 0, x: 20, scale: 0.5 },
                    className: "bg-[#78350f] text-white px-6 py-3 rounded-2xl shadow-xl font-bold text-sm border-2 border-orange-300"
                  }, n.text)
                )
              )
            ),

            React.createElement('div', { className: "text-center mb-12 relative" },
              React.createElement(AnimatePresence, { mode: "wait" },
                React.createElement(motion.div, {
                  key: goldenBuffActive ? 'buff' : 'normal',
                  initial: { y: 10, opacity: 0 },
                  animate: { y: 0, opacity: 1 },
                  exit: { y: -10, opacity: 0 },
                  className: `text-7xl font-black drop-shadow-lg ${goldenBuffActive ? 'text-yellow-600' : 'text-[#78350f]'}`
                }, Math.floor(poops).toLocaleString())
              ),
              React.createElement('div', { className: "text-xl font-bold text-[#b45309] uppercase tracking-widest opacity-80" }, 'Brown Gold'),
              
              React.createElement('div', { className: "flex gap-4 justify-center mt-4" },
                isFrenzy && React.createElement(motion.div, {
                  animate: { scale: [1, 1.2, 1] },
                  transition: { repeat: Infinity },
                  className: "text-orange-500 font-black text-xl"
                }, 'FRENZY!'),
                goldenBuffActive && React.createElement(motion.div, {
                  animate: { scale: [1, 1.2, 1] },
                  transition: { repeat: Infinity },
                  className: "text-yellow-600 font-black text-xl"
                }, `GOLDEN: ${goldenBuffTime}s`)
              )
            ),

            React.createElement(Clicker, {
              onClick: handleManualClick,
              cpc: cpc * (isFrenzy ? 2 : 1) * (goldenBuffActive ? goldenBasePower : 1),
              isFrenzy,
              isGolden: goldenBuffActive
            })
          ),

          // Shop
          React.createElement(motion.aside, {
            initial: { x: 100, opacity: 0 },
            animate: { x: 0, opacity: 1 },
            className: "w-full md:w-96 glass border-l-4 border-[#dcd2b3] p-6 overflow-y-auto h-screen z-10"
          },
            React.createElement('h2', { className: "text-2xl font-black text-[#78350f] mb-6 border-b-2 border-[#78350f] pb-2 flex justify-between items-center" },
              React.createElement('span', null, 'Upgrades'),
              React.createElement('span', { className: "text-sm opacity-50" }, 'ðŸ›’')
            ),
            React.createElement(Shop, { upgrades, poops, onBuy: buyUpgrade })
          )
        );
      };

      // ============ RENDER ============
      const root = createRoot(document.getElementById('root'));
      root.render(React.createElement(App));
    </script>
</body>
</html>
